#lang rhombus

check:
  block:
    guard #false | 1
    2
  ~is 1

check:
  block:
    guard #true | 1
    2
  ~is 2

check:
  block:
    let x = 1
    guard x > 0
    | let y = x - 1
      -100
    let y = x + 1
    100
  ~is 100

check:
  block:
    let x = 1
    guard x < 0
    | let y = x - 1
      -100
    let y = x + 1
    100
  ~is -100

class Point(x, y)

check:
  block:
    guard.let Point(x, y) = #false | 100
    x + y
  ~is 100

check:
  block:
    guard.let Point(x, y) = Point(1, 2) | 100
    x + y
  ~is 3


check:
  block:
    guard.let Point(x, y) = #false
    | let x = 42
      let y = 43
      100
    let z = x + y
    z
  ~is 100

check:
  block:
    guard.let Point(x, y) = Point(1, 2)
    | let x = 42
      let y = 43
      100
    let z = x + y
    z
  ~is 3


check:
  block:
    guard.let Point(x, y):
      let foo = 42
      #false
    | 100
    x + y
  ~is 100

check:
  block:
    guard.let Point(x, y):
      let foo = 42
      Point(1, 2)
    | 100
    x + y
  ~is 3
